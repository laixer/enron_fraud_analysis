---
title: "Untitled"
output: html_document
---

```{r, echo=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(gridExtra)
```


```{r load_data, cache=TRUE}
enron <- read.csv("final_project_dataset.csv", na.strings = "NaN")
```

```{r, message=FALSE, fig.width=10}
ggplot(enron, aes(salary, fill=poi)) + 
  geom_histogram(alpha=0.5, position="identity") +
  scale_fill_brewer(palette="Set1")
```

Some kind of outlier in the top graph.

```{r}
enron %>%
  arrange(desc(salary)) %>%
  select(name, salary) %>%
  head()
```

Let's remove the 'TOTAL' data.

```{r}
enron <- enron %>%
  filter(name != "TOTAL")
```

Replot the salary data.

```{r, message=FALSE, fig.width=10}
ggplot(enron, aes(salary)) + 
  geom_histogram(binwidth=20000) + 
  facet_wrap(~ poi, ncol=2)
```

Salary doesn't seem like a particularly useful indicator.

```{r, messages=FALSE, fig.width=10, fig.height=40}
g1 <- ggplot(enron, aes(deferral_payments, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g2 <- ggplot(enron, aes(total_payments, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g3 <- ggplot(enron, aes(exercised_stock_options, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g4 <- ggplot(enron, aes(bonus, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g5 <- ggplot(enron, aes(restricted_stock, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g6 <- ggplot(enron, aes(restricted_stock_deferred, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g7 <- ggplot(enron, aes(total_stock_value, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g8 <- ggplot(enron, aes(expenses, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g9 <- ggplot(enron, aes(other, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g10 <- ggplot(enron, aes(director_fees, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g11 <- ggplot(enron, aes(deferred_income, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g12 <- ggplot(enron, aes(long_term_incentive, fill=poi)) + geom_histogram(alpha=0.5, position="identity")

grid.arrange(g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, ncol=1)
```

deferral_payments - noticeably different, worth a closer look
total_payments - outlier worth a closer look
exercised_stock_options - seems to be a feature worth trying
bonus - worth a try, not clear how useful it will be
restricted_stock - not interesting
restricted_stock_deferred - not interesting
total_stock_value - maybe
expenses - not interesting
other - outlier worth a closer look
director_fees - not interesting
deferred_income - maybe
long_term_incentive - not interesting

```{r, messages=FALSE, fig.width=10, fig.height=40}
enron %>%
  arrange(desc(total_payments)) %>%
  select(name, total_payments) %>%
  head()
```

Doesn't look like total_payments would do well to tell apart POIs.

```{r, messages=FALSE, fig.width=10, fig.height=40}
enron %>%
  arrange(desc(other)) %>%
  select(name, other) %>%
  head()
```

Outlier is Kenneth Lay again. If we ignore him, this feature doesn't seem to a 
good indicator.

Let's try using deferral_payments, exercised_stock_options, bonus, 
total_stock_value, deferred_income from financial features.


What about e-mail features?

to_messages
shared_receipt_with_poi
from_messages
from_this_person_to_poi
from_poi_to_this_person

```{r, messages=FALSE, fig.width=10, fig.height=40}
g1 <- ggplot(enron, aes(to_messages, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g2 <- ggplot(enron, aes(shared_receipt_with_poi, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g3 <- ggplot(enron, aes(from_messages, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g4 <- ggplot(enron, aes(from_this_person_to_poi, fill=poi)) + geom_histogram(alpha=0.5, position="identity")
g5 <- ggplot(enron, aes(from_poi_to_this_person, fill=poi)) + geom_histogram(alpha=0.5, position="identity")

grid.arrange(g1, g2, g3, g4, g5, ncol=1)
```
